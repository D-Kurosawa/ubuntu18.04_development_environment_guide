# Pythonのインストール

Ubuntuを含むほとんどのLinuxディストリビューション(FreeBSD、NetBSD、OpenBSD、macOS)では、Pythonはデフォルトでインストールされるか、システムのパッケージリポジトリにPythonを収録しています。これらの環境の多くは、Pythonをコアコンポーネントの一部として利用しています。UbuntuのインストーラーのUbiquityなどはPython上で動作します。

このため、システムのパッケージ管理ツール(aptなど)が管理するシステムのネイティブパッケージとして、PyPI由来の数多くのパッケージをインストールできます。しかし、入手できるライブラリの数はPyPIよりも少なく、またほとんどのライブラリのバージョンが古い点に注意が必要です。

また、最新のパッケージの取得にはPyPA(Pythonパッケージオーソリティ)が推奨しているとおり`pip`コマンドを使うべきです。

## 1. 環境分離の必要性

`pip`は、システム全体で使われるパッケージのインストールに使われることが多いでしょう。UnixベースのシステムやLinuxのシステムであれば、スーパーユーザー権限が必要になるため、実際には以下の形式で実行されます。

```bash
sudo pip install <パッケージ名>
```

システム全体から使われるパッケージをPyPIから直接インストールすることはお勧めできませんし、避けるべきです。これは先に説明したように、Pythonはオペレーティングシステムのパッケージリポジトリ経由でインストールされる多くのパッケージの一部として使われる場合が非常に多く、重要なシステムを駆動するのにも使われているからです。システムディストリビューションのメンテナーは、さまざまなパッケージの依存関係が壊れないように、パッケージのバージョンの選択に非常に多くの時間を費やしています。そのために、システムのリポジトリで提供されるPythonのパッケージは、システム固有のパッチが当たっていたり、他のコンポーネントとの依存関係を維持するために、古いバージョンに固定されていることがあります。これらのパッケージを`pip`を使って強制的に最新バージョンに更新してしまうと、後方互換性が崩れたり、システムの重要なサービスが動作しなくなることがあります。

開発目的だとしてもローカルコンピュータ上でこのようなことをやって良いことにはなりません。`pip`を強引に使用すると、デバッグが非常に難しいトラブルに遭遇する確率が上がります。`pip`を使ってシステムグローバルにパッケージをインストールすることを禁止はしませんが、リスクを認識しながら行うべきことであると意識してください。

この問題は、環境を分離することで簡単に解決できます。環境分離のためのツールは数種類あり、それぞれ異なるレベルでシステムを抽象化し、Pythonランタイム環境を分離します。もっともよく利用されるのが、システム、サービス、プロジェクト、それぞれに必要なパッケージや依存関係を分離するツールです。この方法には次のようなメリットがあります。

- プロジェクトXはライブラリZのバージョン1.xに依存するが、プロジェクトYはライブラリZの4.x を必要とする、というジレンマを解消します。依存ライブラリが衝突してお互いに影響を与えるようなリスクを避けながら、開発者が複数のプロジェクトを同時に扱えるようになります。
- 開発者が、使用しているシステムのディストリビューションリポジトリで提供されているパッケージのバージョンに拘束されることなく、プロジェクト側で任意に決定できるようになります。
- 開発環境にのみ導入された新しいパッケージのバージョンにより、特定のパッケージバージョンに依存するシステムサービスに影響を与えることがなくなります。
- プロジェクトに依存関係のあるパッケージ一覧を簡単に**凍結**できます。新しいシステム上で
同じ環境を再現することが簡単に行えます。

環境を分離する方法のうち、もっとも簡単で軽量な方法が、アプリケーションレベルの仮想環境を使用することです。この方法は、Pythonインタープリタとそれが使用可能なパッケージを分離することだけを行います。セットアップは簡単で、小さいプロジェクトやパッケージの開発には十分です。
